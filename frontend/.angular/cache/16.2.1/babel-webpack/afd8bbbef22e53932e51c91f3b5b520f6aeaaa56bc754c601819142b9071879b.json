{"ast":null,"code":"\"use strict\";\n\nvar _class;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BookingService = void 0;\nconst tslib_1 = require(\"tslib\");\nconst http_1 = require(\"@angular/common/http\");\nconst core_1 = require(\"@angular/core\");\nconst rxjs_1 = require(\"rxjs\");\nconst i0 = tslib_1.__importStar(require(\"@angular/core\"));\nconst i1 = tslib_1.__importStar(require(\"@angular/common/http\"));\nconst i2 = tslib_1.__importStar(require(\"ngx-toastr\"));\nconst i3 = tslib_1.__importStar(require(\"@angular/router\"));\nconst i4 = tslib_1.__importStar(require(\"../app.service\"));\nclass BookingService {\n  constructor(http, toastrService, router, appService) {\n    this.http = http;\n    this.toastrService = toastrService;\n    this.router = router;\n    this.appService = appService;\n    this.isBooking = (0, core_1.signal)(false);\n    //clear the form once the booking is a success\n    this.isBookingSuccess = new rxjs_1.BehaviorSubject(false);\n  }\n  book(booking) {\n    //show loader\n    this.isBooking.set(true);\n    const url = 'http://localhost:8000/booking';\n    const headers = new http_1.HttpHeaders().set('Content-Type', 'application/json');\n    let bookingDto = {\n      name: booking.name,\n      email: booking.email,\n      phone: booking.phone,\n      address: booking.address,\n      time: booking.time,\n      date: booking.date,\n      service: booking.service\n    };\n    this.http.post(url, bookingDto, {\n      headers\n    }).subscribe(response => {\n      //disable loading button\n      this.isBooking.set(false);\n      this.appService.showSuccessToast('Your driving lesson booking is confirmed', '', 'bottom-center');\n      this.isBookingSuccess.next(true);\n      this.router.navigateByUrl('/booking');\n    }, error => {\n      //show toast\n      //show toast\n      let message = error['error']['message'] ? error['error']['message'] : error['error']['error'] ? error['error']['error'] : 'Please review your data and try again.';\n      this.appService.showFailureToast(message, 'Booking submission failed', 'bottom-center');\n      //disable loading button\n      this.isBooking.set(false);\n    });\n  }\n}\n_class = BookingService;\n_class.ɵfac = function BookingService_Factory(t) {\n  return new (t || _class)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.ToastrService), i0.ɵɵinject(i3.Router), i0.ɵɵinject(i4.AppService));\n};\n_class.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: _class,\n  factory: _class.ɵfac,\n  providedIn: 'root'\n});\nexports.BookingService = BookingService;","map":{"version":3,"names":["http_1","require","core_1","rxjs_1","BookingService","constructor","http","toastrService","router","appService","isBooking","signal","isBookingSuccess","BehaviorSubject","book","booking","set","url","headers","HttpHeaders","bookingDto","name","email","phone","address","time","date","service","post","subscribe","response","showSuccessToast","next","navigateByUrl","error","message","showFailureToast","i0","ɵɵinject","i1","HttpClient","i2","ToastrService","i3","Router","i4","AppService","factory","ɵfac","providedIn","exports"],"sources":["C:\\Users\\Pierce T. Nyamuda\\Documents\\BYUI Courses\\spring2023\\Angular\\final-project\\frontend\\src\\app\\booking\\booking.service.ts"],"sourcesContent":["import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable, WritableSignal, signal } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\nimport { ToastrService } from 'ngx-toastr';\nimport { Booking } from './booking.model';\nimport { Router } from '@angular/router';\nimport { AppService } from '../app.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class BookingService {\n  public isBooking: WritableSignal<boolean> = signal(false);\n\n  //clear the form once the booking is a success\n  public isBookingSuccess = new BehaviorSubject<boolean>(false);\n\n  constructor(\n    private http: HttpClient,\n    private toastrService: ToastrService,\n    private router: Router,\n    private appService: AppService\n  ) {}\n\n  book(booking: Booking) {\n    //show loader\n    this.isBooking.set(true);\n\n    const url = 'http://localhost:8000/booking';\n    const headers = new HttpHeaders().set('Content-Type', 'application/json');\n\n    let bookingDto = {\n      name: booking.name,\n      email: booking.email,\n      phone: booking.phone,\n      address: booking.address,\n      time: booking.time,\n      date: booking.date,\n      service: booking.service,\n    };\n    this.http.post(url, bookingDto, { headers }).subscribe(\n      (response) => {\n        //disable loading button\n        this.isBooking.set(false);\n        this.appService.showSuccessToast(\n          'Your driving lesson booking is confirmed',\n          '',\n          'bottom-center'\n        );\n        this.isBookingSuccess.next(true);\n        this.router.navigateByUrl('/booking');\n      },\n      (error) => {\n        //show toast\n        //show toast\n        let message = error['error']['message']\n          ? error['error']['message']\n          : error['error']['error']\n          ? error['error']['error']\n          : 'Please review your data and try again.';\n        this.appService.showFailureToast(\n          message,\n          'Booking submission failed',\n          'bottom-center'\n        );\n        //disable loading button\n        this.isBooking.set(false);\n      }\n    );\n  }\n}\n"],"mappings":";;;;;;;;AAAA,MAAAA,MAAA,GAAAC,OAAA;AACA,MAAAC,MAAA,GAAAD,OAAA;AACA,MAAAE,MAAA,GAAAF,OAAA;;;;;;AAMA,MAGaG,cAAc;EAMzBC,YACUC,IAAgB,EAChBC,aAA4B,EAC5BC,MAAc,EACdC,UAAsB;IAHtB,KAAAH,IAAI,GAAJA,IAAI;IACJ,KAAAC,aAAa,GAAbA,aAAa;IACb,KAAAC,MAAM,GAANA,MAAM;IACN,KAAAC,UAAU,GAAVA,UAAU;IATb,KAAAC,SAAS,GAA4B,IAAAR,MAAA,CAAAS,MAAM,EAAC,KAAK,CAAC;IAEzD;IACO,KAAAC,gBAAgB,GAAG,IAAIT,MAAA,CAAAU,eAAe,CAAU,KAAK,CAAC;EAO1D;EAEHC,IAAIA,CAACC,OAAgB;IACnB;IACA,IAAI,CAACL,SAAS,CAACM,GAAG,CAAC,IAAI,CAAC;IAExB,MAAMC,GAAG,GAAG,+BAA+B;IAC3C,MAAMC,OAAO,GAAG,IAAIlB,MAAA,CAAAmB,WAAW,EAAE,CAACH,GAAG,CAAC,cAAc,EAAE,kBAAkB,CAAC;IAEzE,IAAII,UAAU,GAAG;MACfC,IAAI,EAAEN,OAAO,CAACM,IAAI;MAClBC,KAAK,EAAEP,OAAO,CAACO,KAAK;MACpBC,KAAK,EAAER,OAAO,CAACQ,KAAK;MACpBC,OAAO,EAAET,OAAO,CAACS,OAAO;MACxBC,IAAI,EAAEV,OAAO,CAACU,IAAI;MAClBC,IAAI,EAAEX,OAAO,CAACW,IAAI;MAClBC,OAAO,EAAEZ,OAAO,CAACY;KAClB;IACD,IAAI,CAACrB,IAAI,CAACsB,IAAI,CAACX,GAAG,EAAEG,UAAU,EAAE;MAAEF;IAAO,CAAE,CAAC,CAACW,SAAS,CACnDC,QAAQ,IAAI;MACX;MACA,IAAI,CAACpB,SAAS,CAACM,GAAG,CAAC,KAAK,CAAC;MACzB,IAAI,CAACP,UAAU,CAACsB,gBAAgB,CAC9B,0CAA0C,EAC1C,EAAE,EACF,eAAe,CAChB;MACD,IAAI,CAACnB,gBAAgB,CAACoB,IAAI,CAAC,IAAI,CAAC;MAChC,IAAI,CAACxB,MAAM,CAACyB,aAAa,CAAC,UAAU,CAAC;IACvC,CAAC,EACAC,KAAK,IAAI;MACR;MACA;MACA,IAAIC,OAAO,GAAGD,KAAK,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,GACnCA,KAAK,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,GACzBA,KAAK,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,GACvBA,KAAK,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,GACvB,wCAAwC;MAC5C,IAAI,CAACzB,UAAU,CAAC2B,gBAAgB,CAC9BD,OAAO,EACP,2BAA2B,EAC3B,eAAe,CAChB;MACD;MACA,IAAI,CAACzB,SAAS,CAACM,GAAG,CAAC,KAAK,CAAC;IAC3B,CAAC,CACF;EACH;;SA1DWZ,cAAc;;mBAAdA,MAAc,EAAAiC,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,aAAA,GAAAL,EAAA,CAAAC,QAAA,CAAAK,EAAA,CAAAC,MAAA,GAAAP,EAAA,CAAAC,QAAA,CAAAO,EAAA,CAAAC,UAAA;AAAA;;SAAd1C,MAAc;EAAA2C,OAAA,EAAd3C,MAAc,CAAA4C,IAAA;EAAAC,UAAA,EAFb;AAAM;AADpBC,OAAA,CAAA9C,cAAA,GAAAA,cAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}